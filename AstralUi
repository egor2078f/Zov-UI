local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")

local Library = {}
local UI = {}

--// Настройки Темы //--
Library.Theme = {
	Main = Color3.fromRGB(20, 20, 20),
	Header = Color3.fromRGB(25, 25, 25),
	Element = Color3.fromRGB(30, 30, 30),
	Text = Color3.fromRGB(255, 255, 255),
	SubText = Color3.fromRGB(160, 160, 160),
	Accent = Color3.fromRGB(114, 137, 218), -- Discord Blurple стиль
	Stroke = Color3.fromRGB(45, 45, 45),
	Font = Enum.Font.GothamMedium
}

--// Утилиты //--
local function Create(instance, properties)
	local obj = Instance.new(instance)
	for k, v in pairs(properties) do
		obj[k] = v
	end
	return obj
end

local function Round(obj, radius)
	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0, radius or 6)
	corner.Parent = obj
	return corner
end

local function Stroke(obj, color, thickness)
	local stroke = Instance.new("UIStroke")
	stroke.Color = color or Library.Theme.Stroke
	stroke.Thickness = thickness or 1
	stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	stroke.Parent = obj
	return stroke
end

local function MakeDraggable(trigger, frame)
	local dragging, dragInput, dragStart, startPos

	trigger.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
			dragging = true
			dragStart = input.Position
			startPos = frame.Position

			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then
					dragging = false
				end
			end)
		end
	end)

	trigger.InputChanged:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
			dragInput = input
		end
	end)

	UserInputService.InputChanged:Connect(function(input)
		if input == dragInput and dragging then
			local delta = input.Position - dragStart
			TweenService:Create(frame, TweenInfo.new(0.05), {Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)}):Play()
		end
	end)
end

--// Главная функция //--
function Library:CreateWindow(hubName)
	local ScreenGui = Create("ScreenGui", {
		Name = "AstralMobileLib",
		Parent = (RunService:IsStudio() and Players.LocalPlayer.PlayerGui) or CoreGui,
		ResetOnSpawn = false,
		ZIndexBehavior = Enum.ZIndexBehavior.Sibling
	})
	
	-- Кнопка открытия/закрытия (Mobile Toggle)
	local OpenBtn = Create("ImageButton", {
		Name = "OpenButton",
		Parent = ScreenGui,
		Size = UDim2.new(0, 50, 0, 50),
		Position = UDim2.new(0.1, 0, 0.1, 0),
		BackgroundColor3 = Library.Theme.Main,
		BorderColor3 = Library.Theme.Accent,
		BorderSizePixel = 2,
		Image = "rbxassetid://3926305904", -- Иконка
		ImageRectOffset = Vector2.new(964, 204),
		ImageRectSize = Vector2.new(36, 36),
		ImageColor3 = Library.Theme.Accent
	})
	Round(OpenBtn, 12)
	MakeDraggable(OpenBtn, OpenBtn) -- Кнопку можно таскать

	local MainFrame = Create("Frame", {
		Name = "MainFrame",
		Parent = ScreenGui,
		Size = UDim2.new(0, 320, 0, 420), -- Узкое, компактное
		Position = UDim2.new(0.5, -160, 0.5, -210),
		BackgroundColor3 = Library.Theme.Main,
		BorderSizePixel = 0,
		ClipsDescendants = true,
		Visible = false -- Скрыто по умолчанию
	})
	Round(MainFrame, 8)
	Stroke(MainFrame, Library.Theme.Stroke, 2)
	MakeDraggable(MainFrame, MainFrame) -- Окно можно таскать за все тело, если не попадать по элементам

	-- Анимация открытия
	local UI_Open = false
	local function ToggleUI()
		UI_Open = not UI_Open
		MainFrame.Visible = true
		if UI_Open then
			MainFrame.Size = UDim2.new(0, 320, 0, 0)
			TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Size = UDim2.new(0, 320, 0, 420)}):Play()
		else
			local tween = TweenService:Create(MainFrame, TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {Size = UDim2.new(0, 320, 0, 0)})
			tween:Play()
			tween.Completed:Connect(function()
				if not UI_Open then MainFrame.Visible = false end
			end)
		end
	end

	OpenBtn.MouseButton1Click:Connect(ToggleUI)
	
	-- Хоткей для ПК (Right Control)
	UserInputService.InputBegan:Connect(function(input)
		if input.KeyCode == Enum.KeyCode.RightControl then
			ToggleUI()
		end
	end)

	-- Заголовок
	local Header = Create("Frame", {
		Name = "Header",
		Parent = MainFrame,
		Size = UDim2.new(1, 0, 0, 40),
		BackgroundColor3 = Library.Theme.Header,
		BorderSizePixel = 0
	})
	Round(Header, 8)
	
	-- Фикс скругления снизу хедера
	local HeaderFix = Create("Frame", {
		Parent = Header,
		Size = UDim2.new(1, 0, 0, 10),
		Position = UDim2.new(0, 0, 1, -10),
		BackgroundColor3 = Library.Theme.Header,
		BorderSizePixel = 0
	})

	local Title = Create("TextLabel", {
		Parent = Header,
		Size = UDim2.new(1, -20, 1, 0),
		Position = UDim2.new(0, 15, 0, 0),
		BackgroundTransparency = 1,
		Text = hubName,
		TextColor3 = Library.Theme.Text,
		Font = Enum.Font.GothamBold,
		TextSize = 16,
		TextXAlignment = Enum.TextXAlignment.Left
	})

	--// Система навигации (Вкладки как Dropdown) //--
	local NavContainer = Create("Frame", {
		Name = "NavContainer",
		Parent = MainFrame,
		Size = UDim2.new(1, -20, 0, 35),
		Position = UDim2.new(0, 10, 0, 45),
		BackgroundColor3 = Library.Theme.Element,
		ZIndex = 10 -- Поверх всего
	})
	Round(NavContainer, 6)
	Stroke(NavContainer, Library.Theme.Stroke)

	local NavBtn = Create("TextButton", {
		Parent = NavContainer,
		Size = UDim2.new(1, 0, 1, 0),
		BackgroundTransparency = 1,
		Text = "Navigation: Select Tab",
		TextColor3 = Library.Theme.Accent,
		Font = Library.Theme.Font,
		TextSize = 14,
		ZIndex = 11
	})

	local NavListFrame = Create("Frame", {
		Parent = NavContainer,
		Size = UDim2.new(1, 0, 0, 0),
		Position = UDim2.new(0, 0, 1, 5),
		BackgroundColor3 = Library.Theme.Element,
		Visible = false,
		ClipsDescendants = true,
		ZIndex = 12
	})
	Round(NavListFrame, 6)
	Stroke(NavListFrame, Library.Theme.Stroke)
	
	local NavListLayout = Create("UIListLayout", {
		Parent = NavListFrame,
		SortOrder = Enum.SortOrder.LayoutOrder,
		Padding = UDim.new(0, 2)
	})

	local NavOpen = false
	NavBtn.MouseButton1Click:Connect(function()
		NavOpen = not NavOpen
		NavListFrame.Visible = true
		local totalSize = NavListLayout.AbsoluteContentSize.Y + 10
		
		if NavOpen then
			TweenService:Create(NavListFrame, TweenInfo.new(0.2), {Size = UDim2.new(1, 0, 0, totalSize)}):Play()
		else
			TweenService:Create(NavListFrame, TweenInfo.new(0.2), {Size = UDim2.new(1, 0, 0, 0)}):Play()
			wait(0.2)
			if not NavOpen then NavListFrame.Visible = false end
		end
	end)

	-- Контейнер для страниц
	local PagesContainer = Create("Frame", {
		Name = "Pages",
		Parent = MainFrame,
		Size = UDim2.new(1, -20, 1, -95),
		Position = UDim2.new(0, 10, 0, 85),
		BackgroundTransparency = 1
	})

	local Tabs = {}
	
	-- Функция создания вкладки
	function Library:Tab(name)
		-- Скрываем предыдущие
		for _, page in pairs(PagesContainer:GetChildren()) do
			if page:IsA("ScrollingFrame") then page.Visible = false end
		end

		local Page = Create("ScrollingFrame", {
			Name = name,
			Parent = PagesContainer,
			Size = UDim2.new(1, 0, 1, 0),
			BackgroundTransparency = 1,
			ScrollBarThickness = 2,
			ScrollBarImageColor3 = Library.Theme.Accent,
			Visible = true -- Первая созданная будет видна
		})
		
		local PageLayout = Create("UIListLayout", {
			Parent = Page,
			SortOrder = Enum.SortOrder.LayoutOrder,
			Padding = UDim.new(0, 6)
		})
		
		local PagePadding = Create("UIPadding", {
			Parent = Page,
			PaddingTop = UDim.new(0, 5),
			PaddingLeft = UDim.new(0, 2),
			PaddingRight = UDim.new(0, 2),
			PaddingBottom = UDim.new(0, 5)
		})

		-- Авто-ресайз
		PageLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
			Page.CanvasSize = UDim2.new(0, 0, 0, PageLayout.AbsoluteContentSize.Y + 20)
		end)

		-- Добавляем кнопку в Навигацию
		local TabBtn = Create("TextButton", {
			Parent = NavListFrame,
			Size = UDim2.new(1, -10, 0, 30),
			BackgroundColor3 = Color3.fromRGB(40,40,40),
			Text = name,
			TextColor3 = Library.Theme.SubText,
			Font = Library.Theme.Font,
			TextSize = 14,
			ZIndex = 13
		})
		Round(TabBtn, 4)
		
		-- Центровка кнопки в списке
		Create("UIListLayout", {Parent = NavListFrame, HorizontalAlignment = Enum.HorizontalAlignment.Center}) 

		TabBtn.MouseButton1Click:Connect(function()
			-- Скрыть все
			for _, p in pairs(PagesContainer:GetChildren()) do
				if p:IsA("ScrollingFrame") then p.Visible = false end
			end
			-- Показать текущую
			Page.Visible = true
			NavBtn.Text = "Navigation: " .. name
			
			-- Закрыть навигацию
			NavOpen = false
			TweenService:Create(NavListFrame, TweenInfo.new(0.2), {Size = UDim2.new(1, 0, 0, 0)}):Play()
			wait(0.2)
			NavListFrame.Visible = false
		end)

		-- Если это первая вкладка, ставим текст
		if #NavListFrame:GetChildren() == 2 then -- 2 потому что Layout там уже есть
			NavBtn.Text = "Navigation: " .. name
		else
			Page.Visible = false
		end
		
		local Elements = {}

		--// Button //--
		function Elements:Button(text, callback)
			local BtnFrame = Create("Frame", {
				Parent = Page,
				Size = UDim2.new(1, 0, 0, 32),
				BackgroundColor3 = Library.Theme.Element
			})
			Round(BtnFrame, 6)
			
			local Btn = Create("TextButton", {
				Parent = BtnFrame,
				Size = UDim2.new(1, 0, 1, 0),
				BackgroundTransparency = 1,
				Text = text,
				TextColor3 = Library.Theme.Text,
				Font = Library.Theme.Font,
				TextSize = 13
			})
			
			Btn.MouseButton1Click:Connect(function()
				TweenService:Create(BtnFrame, TweenInfo.new(0.1), {BackgroundColor3 = Library.Theme.Accent}):Play()
				wait(0.1)
				TweenService:Create(BtnFrame, TweenInfo.new(0.3), {BackgroundColor3 = Library.Theme.Element}):Play()
				if callback then callback() end
			end)
		end

		--// Toggle //--
		function Elements:Toggle(text, default, callback)
			local Toggled = default or false
			local ToggleFrame = Create("Frame", {
				Parent = Page,
				Size = UDim2.new(1, 0, 0, 32),
				BackgroundColor3 = Library.Theme.Element
			})
			Round(ToggleFrame, 6)
			
			local Label = Create("TextLabel", {
				Parent = ToggleFrame,
				Size = UDim2.new(1, -50, 1, 0),
				Position = UDim2.new(0, 10, 0, 0),
				BackgroundTransparency = 1,
				Text = text,
				TextColor3 = Library.Theme.Text,
				Font = Library.Theme.Font,
				TextSize = 13,
				TextXAlignment = Enum.TextXAlignment.Left
			})
			
			local SwitchBg = Create("Frame", {
				Parent = ToggleFrame,
				Size = UDim2.new(0, 36, 0, 18),
				Position = UDim2.new(1, -45, 0.5, -9),
				BackgroundColor3 = Toggled and Library.Theme.Accent or Color3.fromRGB(50,50,50)
			})
			Round(SwitchBg, 18)
			
			local Dot = Create("Frame", {
				Parent = SwitchBg,
				Size = UDim2.new(0, 14, 0, 14),
				Position = Toggled and UDim2.new(1, -16, 0.5, -7) or UDim2.new(0, 2, 0.5, -7),
				BackgroundColor3 = Color3.fromRGB(255,255,255)
			})
			Round(Dot, 14)
			
			local Trigger = Create("TextButton", {
				Parent = ToggleFrame,
				Size = UDim2.new(1, 0, 1, 0),
				BackgroundTransparency = 1,
				Text = ""
			})
			
			Trigger.MouseButton1Click:Connect(function()
				Toggled = not Toggled
				local targetPos = Toggled and UDim2.new(1, -16, 0.5, -7) or UDim2.new(0, 2, 0.5, -7)
				local targetCol = Toggled and Library.Theme.Accent or Color3.fromRGB(50,50,50)
				
				TweenService:Create(Dot, TweenInfo.new(0.2), {Position = targetPos}):Play()
				TweenService:Create(SwitchBg, TweenInfo.new(0.2), {BackgroundColor3 = targetCol}):Play()
				if callback then callback(Toggled) end
			end)
		end

		--// Slider //--
		function Elements:Slider(text, min, max, default, callback)
			local Value = default or min
			local SliderFrame = Create("Frame", {
				Parent = Page,
				Size = UDim2.new(1, 0, 0, 45),
				BackgroundColor3 = Library.Theme.Element
			})
			Round(SliderFrame, 6)
			
			local Label = Create("TextLabel", {
				Parent = SliderFrame,
				Size = UDim2.new(1, -20, 0, 20),
				Position = UDim2.new(0, 10, 0, 2),
				BackgroundTransparency = 1,
				Text = text,
				TextColor3 = Library.Theme.Text,
				Font = Library.Theme.Font,
				TextSize = 13,
				TextXAlignment = Enum.TextXAlignment.Left
			})
			
			local ValLabel = Create("TextLabel", {
				Parent = SliderFrame,
				Size = UDim2.new(0, 50, 0, 20),
				Position = UDim2.new(1, -60, 0, 2),
				BackgroundTransparency = 1,
				Text = tostring(Value),
				TextColor3 = Library.Theme.SubText,
				Font = Library.Theme.Font,
				TextSize = 13,
				TextXAlignment = Enum.TextXAlignment.Right
			})
			
			local BarBg = Create("Frame", {
				Parent = SliderFrame,
				Size = UDim2.new(1, -20, 0, 4),
				Position = UDim2.new(0, 10, 0, 30),
				BackgroundColor3 = Color3.fromRGB(50,50,50)
			})
			Round(BarBg, 2)
			
			local Fill = Create("Frame", {
				Parent = BarBg,
				Size = UDim2.new((Value - min) / (max - min), 0, 1, 0),
				BackgroundColor3 = Library.Theme.Accent
			})
			Round(Fill, 2)
			
			local Trigger = Create("TextButton", {
				Parent = SliderFrame,
				Size = UDim2.new(1, 0, 1, 0),
				BackgroundTransparency = 1,
				Text = ""
			})
			
			local dragging = false
			local function Update(input)
				local sizeX = math.clamp((input.Position.X - BarBg.AbsolutePosition.X) / BarBg.AbsoluteSize.X, 0, 1)
				TweenService:Create(Fill, TweenInfo.new(0.05), {Size = UDim2.new(sizeX, 0, 1, 0)}):Play()
				local val = math.floor(((max - min) * sizeX) + min)
				ValLabel.Text = tostring(val)
				if callback then callback(val) end
			end
			
			Trigger.InputBegan:Connect(function(input)
				if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
					dragging = true
					Update(input)
				end
			end)
			
			UserInputService.InputChanged:Connect(function(input)
				if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
					Update(input)
				end
			end)
			
			UserInputService.InputEnded:Connect(function(input)
				if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
					dragging = false
				end
			end)
		end

		--// Color Picker //--
		function Elements:ColorPicker(text, default, callback)
			local ColorVal = default or Color3.fromRGB(255, 255, 255)
			local PickerOpen = false
			
			local PickerFrame = Create("Frame", {
				Parent = Page,
				Size = UDim2.new(1, 0, 0, 32),
				BackgroundColor3 = Library.Theme.Element,
				ClipsDescendants = true
			})
			Round(PickerFrame, 6)
			
			local Label = Create("TextLabel", {
				Parent = PickerFrame,
				Size = UDim2.new(0.6, 0, 0, 32),
				Position = UDim2.new(0, 10, 0, 0),
				BackgroundTransparency = 1,
				Text = text,
				TextColor3 = Library.Theme.Text,
				Font = Library.Theme.Font,
				TextSize = 13,
				TextXAlignment = Enum.TextXAlignment.Left
			})
			
			local Preview = Create("Frame", {
				Parent = PickerFrame,
				Size = UDim2.new(0, 40, 0, 20),
				Position = UDim2.new(1, -50, 0, 6),
				BackgroundColor3 = ColorVal
			})
			Round(Preview, 4)
			Stroke(Preview, Color3.fromRGB(255,255,255), 1)
			
			local Trigger = Create("TextButton", {
				Parent = PickerFrame,
				Size = UDim2.new(1, 0, 0, 32),
				BackgroundTransparency = 1,
				Text = ""
			})

			-- Контейнер для RGB слайдеров
			local RGBContainer = Create("Frame", {
				Parent = PickerFrame,
				Size = UDim2.new(1, -20, 0, 100),
				Position = UDim2.new(0, 10, 0, 35),
				BackgroundTransparency = 1
			})
			
			local function CreateRGBSlider(comp, yPos)
				local sBg = Create("Frame", {
					Parent = RGBContainer,
					Size = UDim2.new(1, 0, 0, 4),
					Position = UDim2.new(0, 0, 0, yPos),
					BackgroundColor3 = Color3.fromRGB(50,50,50)
				})
				Round(sBg, 2)
				
				local sFill = Create("Frame", {
					Parent = sBg,
					Size = UDim2.new(0, 0, 1, 0),
					BackgroundColor3 = comp == "R" and Color3.fromRGB(255,50,50) or (comp == "G" and Color3.fromRGB(50,255,50) or Color3.fromRGB(50,50,255))
				})
				Round(sFill, 2)
				
				local sBtn = Create("TextButton", {Parent = sBg, Size = UDim2.new(1,0,5,0), Position=UDim2.new(0,0,-2,0), BackgroundTransparency=1, Text=""})
				return sFill, sBtn, sBg
			end
			
			local rFill, rBtn, rBg = CreateRGBSlider("R", 15)
			local gFill, gBtn, gBg = CreateRGBSlider("G", 45)
			local bFill, bBtn, bBg = CreateRGBSlider("B", 75)
			
			local function UpdateColor()
				ColorVal = Color3.fromRGB(
					rFill.Size.X.Scale * 255,
					gFill.Size.X.Scale * 255,
					bFill.Size.X.Scale * 255
				)
				Preview.BackgroundColor3 = ColorVal
				if callback then callback(ColorVal) end
			end
			
			local function Logic(btn, fill, bg)
				local dragging = false
				btn.InputBegan:Connect(function(input)
					if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
						dragging = true
						local sizeX = math.clamp((input.Position.X - bg.AbsolutePosition.X) / bg.AbsoluteSize.X, 0, 1)
						fill.Size = UDim2.new(sizeX, 0, 1, 0)
						UpdateColor()
					end
				end)
				UserInputService.InputChanged:Connect(function(input)
					if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
						local sizeX = math.clamp((input.Position.X - bg.AbsolutePosition.X) / bg.AbsoluteSize.X, 0, 1)
						fill.Size = UDim2.new(sizeX, 0, 1, 0)
						UpdateColor()
					end
				end)
				UserInputService.InputEnded:Connect(function(input)
					if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then dragging = false end
				end)
			end
			
			Logic(rBtn, rFill, rBg)
			Logic(gBtn, gFill, gBg)
			Logic(bBtn, bFill, bBg)
			
			-- Установка начальных значений
			rFill.Size = UDim2.new(ColorVal.R, 0, 1, 0)
			gFill.Size = UDim2.new(ColorVal.G, 0, 1, 0)
			bFill.Size = UDim2.new(ColorVal.B, 0, 1, 0)

			Trigger.MouseButton1Click:Connect(function()
				PickerOpen = not PickerOpen
				TweenService:Create(PickerFrame, TweenInfo.new(0.3), {Size = PickerOpen and UDim2.new(1, 0, 0, 140) or UDim2.new(1, 0, 0, 32)}):Play()
			end)
		end
		
		--// Dropdown //--
		function Elements:Dropdown(text, options, callback)
			local DropOpen = false
			local DropFrame = Create("Frame", {
				Parent = Page,
				Size = UDim2.new(1, 0, 0, 32),
				BackgroundColor3 = Library.Theme.Element,
				ClipsDescendants = true
			})
			Round(DropFrame, 6)
			
			local Label = Create("TextLabel", {
				Parent = DropFrame,
				Size = UDim2.new(1, -30, 0, 32),
				Position = UDim2.new(0, 10, 0, 0),
				BackgroundTransparency = 1,
				Text = text .. "...",
				TextColor3 = Library.Theme.Text,
				Font = Library.Theme.Font,
				TextSize = 13,
				TextXAlignment = Enum.TextXAlignment.Left
			})
			
			local Arrow = Create("TextLabel", {
				Parent = DropFrame,
				Size = UDim2.new(0, 30, 0, 32),
				Position = UDim2.new(1, -30, 0, 0),
				BackgroundTransparency = 1,
				Text = "v",
				TextColor3 = Library.Theme.SubText,
				Font = Enum.Font.GothamBold,
				TextSize = 14
			})
			
			local Trigger = Create("TextButton", {
				Parent = DropFrame,
				Size = UDim2.new(1, 0, 0, 32),
				BackgroundTransparency = 1,
				Text = ""
			})
			
			local ListContainer = Create("Frame", {
				Parent = DropFrame,
				Size = UDim2.new(1, -10, 0, 0),
				Position = UDim2.new(0, 5, 0, 35),
				BackgroundTransparency = 1
			})
			
			local ListLayout = Create("UIListLayout", {
				Parent = ListContainer,
				SortOrder = Enum.SortOrder.LayoutOrder,
				Padding = UDim.new(0, 2)
			})
			
			for _, opt in pairs(options) do
				local OptBtn = Create("TextButton", {
					Parent = ListContainer,
					Size = UDim2.new(1, 0, 0, 25),
					BackgroundColor3 = Color3.fromRGB(45,45,45),
					Text = opt,
					TextColor3 = Library.Theme.SubText,
					Font = Library.Theme.Font,
					TextSize = 12
				})
				Round(OptBtn, 4)
				
				OptBtn.MouseButton1Click:Connect(function()
					Label.Text = text .. ": " .. opt
					if callback then callback(opt) end
					DropOpen = false
					TweenService:Create(DropFrame, TweenInfo.new(0.2), {Size = UDim2.new(1, 0, 0, 32)}):Play()
					Arrow.Text = "v"
				end)
			end
			
			Trigger.MouseButton1Click:Connect(function()
				DropOpen = not DropOpen
				Arrow.Text = DropOpen and "^" or "v"
				local h = ListLayout.AbsoluteContentSize.Y + 40
				TweenService:Create(DropFrame, TweenInfo.new(0.2), {Size = DropOpen and UDim2.new(1, 0, 0, h) or UDim2.new(1, 0, 0, 32)}):Play()
			end)
		end
		
		--// Input //--
		function Elements:Input(text, placeholder, callback)
			local InputFrame = Create("Frame", {
				Parent = Page,
				Size = UDim2.new(1, 0, 0, 45),
				BackgroundColor3 = Library.Theme.Element
			})
			Round(InputFrame, 6)
			
			local Label = Create("TextLabel", {
				Parent = InputFrame,
				Size = UDim2.new(1, -10, 0, 20),
				Position = UDim2.new(0, 10, 0, 2),
				BackgroundTransparency = 1,
				Text = text,
				TextColor3 = Library.Theme.Text,
				Font = Library.Theme.Font,
				TextSize = 13,
				TextXAlignment = Enum.TextXAlignment.Left
			})
			
			local BoxBg = Create("Frame", {
				Parent = InputFrame,
				Size = UDim2.new(1, -20, 0, 20),
				Position = UDim2.new(0, 10, 0, 22),
				BackgroundColor3 = Color3.fromRGB(40,40,40)
			})
			Round(BoxBg, 4)
			
			local Box = Create("TextBox", {
				Parent = BoxBg,
				Size = UDim2.new(1, -10, 1, 0),
				Position = UDim2.new(0, 5, 0, 0),
				BackgroundTransparency = 1,
				Text = "",
				PlaceholderText = placeholder or "...",
				TextColor3 = Library.Theme.Text,
				Font = Library.Theme.Font,
				TextSize = 13,
				TextXAlignment = Enum.TextXAlignment.Left
			})
			
			Box.FocusLost:Connect(function()
				if callback then callback(Box.Text) end
			end)
		end

		return Elements
	end

	-- Открываем меню
	ToggleUI()
	
	return Tabs
end

return Library
